目录 
1
### BY MonkeyD禄腾  ###
2
​
### 1.需要使用的包导入

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from scipy import stats

import warnings
warnings.filterwarnings("ignore")
1
### 1.需要使用的包导入
2
​
3
import pandas as pd
4
import numpy as np
5
import matplotlib.pyplot as plt
6
import seaborn as sns
7
from scipy import stats
8
​
9
import warnings
10
warnings.filterwarnings("ignore")
1
### 2.载入数据
2
data_train =pd.read_csv('train.csv')
3
data_test_a = pd.read_csv('testA.csv')
1
## 3.查看数据的整体信息
2
data_train.info()
<class 'pandas.core.frame.DataFrame'>

RangeIndex: 800000 entries, 0 to 799999

Data columns (total 47 columns):

 #   Column              Non-Null Count   Dtype  

---  ------              --------------   -----  

 0   id                  800000 non-null  int64  

 1   loanAmnt            800000 non-null  float64

 2   term                800000 non-null  int64  

 3   interestRate        800000 non-null  float64

 4   installment         800000 non-null  float64

 5   grade               800000 non-null  object 

 6   subGrade            800000 non-null  object 

 7   employmentTitle     799999 non-null  float64

 8   employmentLength    753201 non-null  object 

 9   homeOwnership       800000 non-null  int64  

 10  annualIncome        800000 non-null  float64

 11  verificationStatus  800000 non-null  int64  

 12  issueDate           800000 non-null  object 

 13  isDefault           800000 non-null  int64  

 14  purpose             800000 non-null  int64  

 15  postCode            799999 non-null  float64

 16  regionCode          800000 non-null  int64  

 17  dti                 799761 non-null  float64

 18  delinquency_2years  800000 non-null  float64

 19  ficoRangeLow        800000 non-null  float64

 20  ficoRangeHigh       800000 non-null  float64

 21  openAcc             800000 non-null  float64

 22  pubRec              800000 non-null  float64

 23  pubRecBankruptcies  799595 non-null  float64

 24  revolBal            800000 non-null  float64

 25  revolUtil           799469 non-null  float64

 26  totalAcc            800000 non-null  float64

 27  initialListStatus   800000 non-null  int64  

 28  applicationType     800000 non-null  int64  

 29  earliesCreditLine   800000 non-null  object 

 30  title               799999 non-null  float64

 31  policyCode          800000 non-null  float64

 32  n0                  759730 non-null  float64

 33  n1                  759730 non-null  float64

 34  n2                  759730 non-null  float64

 35  n3                  759730 non-null  float64

 36  n4                  766761 non-null  float64

 37  n5                  759730 non-null  float64

 38  n6                  759730 non-null  float64

 39  n7                  759730 non-null  float64

 40  n8                  759729 non-null  float64

 41  n9                  759730 non-null  float64

 42  n10                 766761 non-null  float64

 43  n11                 730248 non-null  float64

 44  n12                 759730 non-null  float64

 45  n13                 759730 non-null  float64

 46  n14                 759730 non-null  float64

dtypes: float64(33), int64(9), object(5)

memory usage: 286.9+ MB
1
## 4.进行简单的数据查看
2
data_train.head()
, , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , ,
id	loanAmnt	term	interestRate	installment	grade	subGrade	employmentTitle	employmentLength	homeOwnership	...	n5	n6	n7	n8	n9	n10	n11	n12	n13	n14
0	0	35000.0	5	19.52	917.97	E	E2	320.0	2 years	2	...	9.0	8.0	4.0	12.0	2.0	7.0	0.0	0.0	0.0	2.0
1	1	18000.0	5	18.49	461.90	D	D2	219843.0	5 years	0	...	NaN	NaN	NaN	NaN	NaN	13.0	NaN	NaN	NaN	NaN
2	2	12000.0	5	16.99	298.17	D	D3	31698.0	8 years	0	...	0.0	21.0	4.0	5.0	3.0	11.0	0.0	0.0	0.0	4.0
3	3	11000.0	3	7.26	340.96	A	A4	46854.0	10+ years	1	...	16.0	4.0	7.0	21.0	6.0	9.0	0.0	0.0	0.0	1.0
4	4	3000.0	3	12.99	101.07	C	C2	54.0	NaN	1	...	4.0	9.0	10.0	15.0	7.0	12.0	0.0	0.0	0.0	4.0
,
5 rows × 47 columns

,
1
### 5.特征预处理
2
###区分对象特征和数值特征
3
numerical_features = list(data_train.select_dtypes(exclude=['object']).columns)
4
category_features = list(filter(lambda x: x not in numerical_features,list(data_train.columns)))
5
label = 'isDefault'
6
numerical_features.remove(label)
1
### 6.查看缺失值情况
2
data_train.isnull().sum()
id                        0
,loanAmnt                  0
,term                      0
,interestRate              0
,installment               0
,grade                     0
,subGrade                  0
,employmentTitle           1
,employmentLength      46799
,homeOwnership             0
,annualIncome              0
,verificationStatus        0
,issueDate                 0
,isDefault                 0
,purpose                   0
,postCode                  1
,regionCode                0
,dti                     239
,delinquency_2years        0
,ficoRangeLow              0
,ficoRangeHigh             0
,openAcc                   0
,pubRec                    0
,pubRecBankruptcies      405
,revolBal                  0
,revolUtil               531
,totalAcc                  0
,initialListStatus         0
,applicationType           0
,earliesCreditLine         0
,title                     1
,policyCode                0
,n0                    40270
,n1                    40270
,n2                    40270
,n3                    40270
,n4                    33239
,n5                    40270
,n6                    40270
,n7                    40270
,n8                    40271
,n9                    40270
,n10                   33239
,n11                   69752
,n12                   40270
,n13                   40270
,n14                   40270
,dtype: int64
1
### 7.填充缺失值
2
#按照中位数填充数值型特征
3
data_train[numerical_features] = data_train[numerical_features].fillna(data_train[numerical_features].median())
4
data_test_a[numerical_features] = data_test_a[numerical_features].fillna(data_test_a[numerical_features].median())
5
#按照众数填充类别型特征
6
data_train[category_features] = data_train[category_features].fillna(data_train[category_features].mode())
7
data_test_a[category_features] = data_test_a[category_features].fillna(data_test_a[category_features].mode())
1
### 8.再次查看缺失值情况
2
data_train.isnull().sum()
id                        0
,loanAmnt                  0
,term                      0
,interestRate              0
,installment               0
,grade                     0
,subGrade                  0
,employmentTitle           0
,employmentLength      46799
,homeOwnership             0
,annualIncome              0
,verificationStatus        0
,issueDate                 0
,isDefault                 0
,purpose                   0
,postCode                  0
,regionCode                0
,dti                       0
,delinquency_2years        0
,ficoRangeLow              0
,ficoRangeHigh             0
,openAcc                   0
,pubRec                    0
,pubRecBankruptcies        0
,revolBal                  0
,revolUtil                 0
,totalAcc                  0
,initialListStatus         0
,applicationType           0
,earliesCreditLine         0
,title                     0
,policyCode                0
,n0                        0
,n1                        0
,n2                        0
,n3                        0
,n4                        0
,n5                        0
,n6                        0
,n7                        0
,n8                        0
,n9                        0
,n10                       0
,n11                       0
,n12                       0
,n13                       0
,n14                       0
,dtype: int64
1
### 9.查看类别特征
2
category_features
['grade', 'subGrade', 'employmentLength', 'issueDate', 'earliesCreditLine']
1
### 10.employmentLength转换成数值型
2
def employmentLength_to_int(s):
3
    if pd.isnull(s):
4
        return s
5
    else:
6
        return np.int8(s.split()[0])
7
for data in [data_train, data_test_a]:
8
    data['employmentLength'].replace(to_replace='10+ years', value='10 years', inplace=True)
9
    data['employmentLength'].replace('< 1 year', '0 years', inplace=True)
10
    data['employmentLength'] = data['employmentLength'].apply(employmentLength_to_int)
1
data['employmentLength'].value_counts(dropna=False).sort_index()
0.0     15989
,1.0     13182
,2.0     18207
,3.0     16011
,4.0     11833
,5.0     12543
,6.0      9328
,7.0      8823
,8.0      8976
,9.0      7594
,10.0    65772
,NaN     11742
,Name: employmentLength, dtype: int64
1
### 11.对earliesCreditLine进行处理
2
#这里只取年份
3
for data in [data_train, data_test_a]:
4
    data['earliesCreditLine'] = data['earliesCreditLine'].apply(lambda s: int(s[-4:]))
1
data_train['earliesCreditLine'].head()
0    2001
,1    2002
,2    2006
,3    1999
,4    1977
,Name: earliesCreditLine, dtype: int64
1
### 12.其他类别特征处理
2
cate_features = ['grade', 'subGrade', 'employmentTitle', 'homeOwnership', 'verificationStatus', 'purpose', 'postCode', 'regionCode', \
3
                 'applicationType', 'initialListStatus', 'title', 'policyCode']
4
for f in cate_features:
5
    print(f, '类型数：', data[f].nunique())
grade 类型数： 7

subGrade 类型数： 35

employmentTitle 类型数： 79282

homeOwnership 类型数： 6

verificationStatus 类型数： 3

purpose 类型数： 14

postCode 类型数： 889

regionCode 类型数： 51

applicationType 类型数： 2

initialListStatus 类型数： 2

title 类型数： 12058

policyCode 类型数： 1
1
#首先处理grade转换数值
2
for data in [data_train, data_test_a]:
3
    data['grade'] = data['grade'].map({'A':1,'B':2,'C':3,'D':4,'E':5,'F':6,'G':7})
1
#处理grade转换数值
2
for data in [data_train, data_test_a]:
3
    data['subGrade'] = data['subGrade'].map({ 'A1':1,'A2':2,'A3':3,'A4':4,'A5':5,'B1':6,'B2':7,'B3':8,'B4':9,'B5':10,'C1':11,'C2':12,'C3':13,'C4':14,'C5':15,'D1':16,'D2':17,'D3':18,'D4':19,'D5':20,'E1':21,'E2':22,'E3':23,'E4':24,'E5':25,'F1':26,'F2':27,'F3':28,'F4':29,'F5':30,'G1':31,'G2':32,'G3':33,'G4':34,'G5':35})
1
# 类型数在2之上，又不是高维稀疏的,且纯分类特征
2
for data in [data_train, data_test_a]:
3
    data = pd.get_dummies(data, columns=['subGrade', 'homeOwnership', 'verificationStatus', 'purpose', 'regionCode'], drop_first=True)
1
### 13.画箱式图
2
len(data_train.columns.tolist())
3
​
47
1
data_train.info()
<class 'pandas.core.frame.DataFrame'>

RangeIndex: 800000 entries, 0 to 799999

Data columns (total 47 columns):

 #   Column              Non-Null Count   Dtype  

---  ------              --------------   -----  

 0   id                  800000 non-null  int64  

 1   loanAmnt            800000 non-null  float64

 2   term                800000 non-null  int64  

 3   interestRate        800000 non-null  float64

 4   installment         800000 non-null  float64

 5   grade               800000 non-null  int64  

 6   subGrade            800000 non-null  int64  

 7   employmentTitle     800000 non-null  float64

 8   employmentLength    753201 non-null  float64

 9   homeOwnership       800000 non-null  int64  

 10  annualIncome        800000 non-null  float64

 11  verificationStatus  800000 non-null  int64  

 12  issueDate           800000 non-null  object 

 13  isDefault           800000 non-null  int64  

 14  purpose             800000 non-null  int64  

 15  postCode            800000 non-null  float64

 16  regionCode          800000 non-null  int64  

 17  dti                 800000 non-null  float64

 18  delinquency_2years  800000 non-null  float64

 19  ficoRangeLow        800000 non-null  float64

 20  ficoRangeHigh       800000 non-null  float64

 21  openAcc             800000 non-null  float64

 22  pubRec              800000 non-null  float64

 23  pubRecBankruptcies  800000 non-null  float64

 24  revolBal            800000 non-null  float64

 25  revolUtil           800000 non-null  float64

 26  totalAcc            800000 non-null  float64

 27  initialListStatus   800000 non-null  int64  

 28  applicationType     800000 non-null  int64  

 29  earliesCreditLine   800000 non-null  int64  

 30  title               800000 non-null  float64

 31  policyCode          800000 non-null  float64

 32  n0                  800000 non-null  float64

 33  n1                  800000 non-null  float64

 34  n2                  800000 non-null  float64

 35  n3                  800000 non-null  float64

 36  n4                  800000 non-null  float64

 37  n5                  800000 non-null  float64

 38  n6                  800000 non-null  float64

 39  n7                  800000 non-null  float64

 40  n8                  800000 non-null  float64

 41  n9                  800000 non-null  float64

 42  n10                 800000 non-null  float64

 43  n11                 800000 non-null  float64

 44  n12                 800000 non-null  float64

 45  n13                 800000 non-null  float64

 46  n14                 800000 non-null  float64

dtypes: float64(34), int64(12), object(1)

memory usage: 286.9+ MB
1
data_train['policyCode'].unique()
array([1.])
1
column = data_train.columns.tolist()[:47]  # 列表头
2
column.remove('issueDate')
3
column.remove('policyCode')
4
column.remove('isDefault')
5
print(column)
['id', 'loanAmnt', 'term', 'interestRate', 'installment', 'grade', 'subGrade', 'employmentTitle', 'employmentLength', 'homeOwnership', 'annualIncome', 'verificationStatus', 'purpose', 'postCode', 'regionCode', 'dti', 'delinquency_2years', 'ficoRangeLow', 'ficoRangeHigh', 'openAcc', 'pubRec', 'pubRecBankruptcies', 'revolBal', 'revolUtil', 'totalAcc', 'initialListStatus', 'applicationType', 'earliesCreditLine', 'title', 'n0', 'n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10', 'n11', 'n12', 'n13', 'n14']
1
for col in column:
2
    data_train[col] = pd.to_numeric(data_train[col],errors='coerce')
1
fig = plt.figure(figsize=(20, 40))  # 指定绘图对象宽度和高度
2
for i in range(45):
3
    plt.subplot(15, 3, i + 1)  # 16行3列子图data_train
4
    sns.boxplot(data_train[column[i]], orient="v", width=0.5)  # 箱式图
5
    plt.ylabel(column[i], fontsize=8)
6
plt.show()

1
# 查看查看所有数据的直方图和Q-Q图，查看训练集的数据是否近似于正态分布
2
train_cols = 6
3
train_rows = len(column)
4
plt.figure(figsize=(4*train_cols,4*train_rows))
5
​
6
i=0
7
for col in column:
8
    i+=1
9
    ax=plt.subplot(train_rows,train_cols,i)
10
    sns.distplot(data_train[col],fit=stats.norm)
11
    
12
    i+=1
13
    ax=plt.subplot(train_rows,train_cols,i)
14
    res = stats.probplot(data_train[col], plot=plt)
15
plt.show()
1
#查看所有特征变量下，训练集数据和测试集数据的分布情况
2
dist_cols = 6
3
dist_rows = len(column)
4
plt.figure(figsize=(4*dist_cols,4*dist_rows))
5
​
6
i=1
7
for col in column:
8
    ax=plt.subplot(dist_rows,dist_cols,i)
9
    ax = sns.kdeplot(data_train[col], color="Red", shade=True)
10
    ax = sns.kdeplot(data_test_a[col], color="Blue", shade=True)
11
    ax.set_xlabel(col)
12
    ax.set_ylabel("Frequency")
13
    ax = ax.legend(["train","test"])
14
    
15
    i+=1
16
plt.show()

1
#看来只能删掉的id列了，看来只有这一列训练集数据与测试集数据分布不一致
2
column.remove('id')
1
column.append('isDefault')
1
#查看所有特征变量与'isDefault'变量的线性回归关系
2
​
3
fcols = 6
4
frows = len(column)
5
plt.figure(figsize=(5*fcols,4*frows))
6
​
7
i=0
8
for col in column:
9
    i+=1
10
    ax=plt.subplot(frows,fcols,i)
11
    sns.regplot(x=col, y='isDefault', data=data_train, ax=ax, 
12
                scatter_kws={'marker':'.','s':3,'alpha':0.3},
13
                line_kws={'color':'k'});
14
    plt.xlabel(col)
15
    plt.ylabel('isDefault')
16
    
17
    i+=1
18
    ax=plt.subplot(frows,fcols,i)
19
    sns.distplot(data_train[col])
20
    plt.xlabel(col)
21
​
1
data_train1 = data_train.drop(['id','issueDate','policyCode'],axis=1)
2
train_corr = data_train1.corr()
3
train_corr
4
​
, , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , ,
loanAmnt	term	interestRate	installment	grade	subGrade	employmentTitle	employmentLength	homeOwnership	annualIncome	...	n5	n6	n7	n8	n9	n10	n11	n12	n13	n14
loanAmnt	1.000000	0.381142	0.142288	0.953369	0.142547	0.147163	-0.020449	0.089358	-0.141214	0.315361	...	0.195385	0.078587	0.165615	0.168819	0.149601	0.180359	-0.000150	0.002629	-0.018744	-0.018671
term	0.381142	1.000000	0.416827	0.142894	0.424691	0.433750	0.002270	0.054812	-0.084503	0.051000	...	0.047526	0.071095	0.048778	0.052974	0.049677	0.070600	-0.000164	-0.000317	-0.010489	0.024198
interestRate	0.142288	0.416827	1.000000	0.154550	0.953269	0.976593	0.062398	-0.003302	0.051608	-0.073364	...	-0.078163	0.011459	-0.004541	-0.051841	0.087556	-0.007862	0.004564	0.014585	0.027632	0.205297
installment	0.953369	0.142894	0.154550	1.000000	0.145281	0.150236	-0.014739	0.077290	-0.115779	0.305667	...	0.183541	0.063391	0.162462	0.157905	0.157370	0.170391	0.000678	0.004961	-0.013109	0.001727
grade	0.142547	0.424691	0.953269	0.145281	1.000000	0.975609	0.006705	-0.003671	0.051722	-0.069915	...	-0.079906	0.015116	-0.001498	-0.047689	0.089593	-0.002174	0.005023	0.017338	0.029878	0.209909
subGrade	0.147163	0.433750	0.976593	0.150236	0.975609	1.000000	0.007559	-0.004831	0.054794	-0.072980	...	-0.083847	0.014840	-0.002417	-0.050347	0.092418	-0.003392	0.005530	0.017924	0.030846	0.216046
employmentTitle	-0.020449	0.002270	0.062398	-0.014739	0.006705	0.007559	1.000000	-0.013587	-0.013376	-0.018928	...	0.006386	-0.039479	-0.032827	-0.019679	-0.009577	-0.029380	-0.004090	-0.011054	-0.025557	-0.044603
employmentLength	0.089358	0.054812	-0.003302	0.077290	-0.003671	-0.004831	-0.013587	1.000000	-0.128706	0.067188	...	0.111567	-0.045085	0.110750	0.143347	0.123225	0.037015	0.003862	0.007545	0.000055	0.025525
homeOwnership	-0.141214	-0.084503	0.051608	-0.115779	0.051722	0.054794	-0.013376	-0.128706	1.000000	-0.117331	...	-0.055033	-0.065449	-0.036238	-0.069583	-0.044304	-0.090501	0.000099	-0.010865	0.000174	-0.033871
annualIncome	0.315361	0.051000	-0.073364	0.305667	-0.069915	-0.072980	-0.018928	0.067188	-0.117331	1.000000	...	0.126787	0.101787	0.078582	0.101975	0.071384	0.131405	0.005784	0.012138	0.007702	0.052132
verificationStatus	0.223371	0.129071	0.255346	0.225758	0.243509	0.258695	0.010907	0.029196	-0.007803	0.040493	...	0.029489	0.004900	0.025290	0.028041	0.057044	0.014389	0.014463	0.005365	0.010929	0.110126
isDefault	0.065210	0.175126	0.259202	0.051524	0.261858	0.267724	-0.030714	-0.015822	0.054599	-0.042782	...	-0.016758	0.006611	0.033101	-0.004530	0.068687	0.025849	-0.000295	0.003572	0.011021	0.084551
purpose	-0.153392	-0.086745	-0.061955	-0.149534	-0.060887	-0.063828	0.010891	-0.037831	0.052423	-0.004965	...	-0.025672	-0.025355	-0.042951	-0.042154	-0.055240	-0.042378	-0.000438	-0.000742	-0.001675	-0.030837
postCode	-0.025191	0.010389	0.006350	-0.028734	0.006778	0.006660	-0.012645	0.039103	-0.034059	-0.047760	...	-0.031270	0.053422	-0.028837	-0.015057	-0.028482	-0.020502	-0.002506	0.001762	-0.005995	0.001129
regionCode	-0.011381	0.004851	0.002452	-0.012978	0.003171	0.003306	-0.012470	0.003762	-0.022286	-0.022829	...	-0.005334	0.027303	-0.013382	-0.009294	-0.015040	-0.005505	0.000897	0.001902	-0.001727	0.004229
dti	0.032466	0.058775	0.146632	0.036410	0.145997	0.151193	-0.055000	0.025624	0.000992	-0.141972	...	0.054464	0.175122	0.140165	0.101748	0.195069	0.217581	-0.002841	0.006242	-0.011042	0.070763
delinquency_2years	-0.002052	-0.008589	0.048216	0.007405	0.052983	0.054634	-0.034945	0.021592	-0.030878	0.041592	...	0.033565	0.087103	0.008152	0.077419	-0.008102	0.047912	0.041788	0.102643	0.653769	-0.023048
ficoRangeLow	0.102498	-0.001435	-0.405105	0.052370	-0.406418	-0.423506	0.030705	0.018688	-0.062044	0.072809	...	0.048041	-0.017451	0.009134	0.016358	-0.184593	0.029279	-0.016370	-0.030116	-0.102273	-0.092292
ficoRangeHigh	0.102497	-0.001435	-0.405101	0.052370	-0.406414	-0.423503	0.030704	0.018689	-0.062045	0.072810	...	0.048041	-0.017453	0.009133	0.016358	-0.184593	0.029277	-0.016370	-0.030116	-0.102271	-0.092294
openAcc	0.185288	0.070422	-0.003662	0.175928	0.001641	0.000327	-0.046753	0.042909	-0.095374	0.135522	...	0.503437	0.384903	0.817523	0.636439	0.650537	0.983890	0.004602	0.017091	0.015055	0.360776
pubRec	-0.066391	-0.019313	0.052276	-0.055170	0.059158	0.060318	-0.066005	0.031045	0.005299	-0.008166	...	-0.003987	-0.011152	0.003667	0.020254	-0.006532	-0.027038	0.002233	-0.005064	0.000891	0.084913
pubRecBankruptcies	-0.095719	-0.010871	0.058074	-0.087973	0.060659	0.062174	-0.051854	0.027686	0.005675	-0.047092	...	0.014552	-0.004801	0.006254	0.055980	-0.020998	-0.032641	-0.001589	-0.012805	-0.005773	0.096128
revolBal	0.315078	0.073060	-0.026073	0.303178	-0.024333	-0.024286	-0.012151	0.083628	-0.106325	0.288426	...	0.217944	0.012745	0.228971	0.209494	0.290632	0.216279	-0.003720	0.003013	-0.032548	-0.024096
revolUtil	0.108128	0.063434	0.243290	0.126580	0.239953	0.250330	0.059202	0.035723	-0.044275	0.035332	...	-0.122145	0.013639	-0.198060	-0.170955	0.113231	-0.139386	-0.012088	-0.019853	-0.011362	-0.210524
totalAcc	0.208138	0.098097	-0.041803	0.185532	-0.036153	-0.038922	-0.031794	0.104914	-0.156827	0.177919	...	0.610793	0.664214	0.544573	0.745499	0.384855	0.684596	0.009773	0.020532	0.071189	0.319577
initialListStatus	-0.064204	-0.101012	0.121847	-0.019715	0.106619	0.101342	0.238450	-0.015678	0.014658	-0.042023	...	-0.002328	-0.037806	-0.029951	-0.012594	0.009140	-0.031757	-0.000625	-0.001551	-0.007407	-0.002185
applicationType	0.072605	0.041958	0.040646	0.067570	0.022585	0.024447	-0.033622	-0.040109	-0.040282	-0.037552	...	-0.041906	0.003629	-0.018278	-0.029784	-0.025622	-0.012873	-0.001729	-0.002938	-0.004270	-0.004615
earliesCreditLine	-0.149048	-0.035932	0.115753	-0.129737	0.110164	0.115531	-0.022986	-0.214442	0.100945	-0.129337	...	-0.271187	-0.009221	-0.163330	-0.306072	-0.149992	-0.123161	-0.010287	-0.021363	-0.033833	0.021036
title	-0.025372	-0.018768	0.021513	-0.018836	-0.015715	-0.016314	0.340204	-0.004879	-0.007563	-0.018966	...	0.013543	-0.033046	-0.026952	-0.010610	-0.011414	-0.027918	-0.003010	-0.006013	-0.019196	-0.040406
n0	-0.043741	-0.016233	0.045036	-0.034353	0.048871	0.050623	-0.060274	0.017362	-0.001343	0.019186	...	0.071723	0.129564	-0.013932	0.085510	-0.019599	0.025427	0.035617	-0.002456	0.315172	0.082023
n1	0.194087	0.043204	0.025581	0.197646	0.023624	0.024394	-0.017095	0.076012	-0.027566	0.104315	...	0.578655	-0.029067	0.653255	0.444918	0.801244	0.538877	-0.004401	-0.003536	-0.031097	0.161047
n2	0.150474	0.049456	0.087937	0.158371	0.090149	0.092871	-0.014158	0.122216	-0.045604	0.072592	...	0.474916	0.000589	0.790764	0.568452	0.982045	0.653450	-0.003080	0.003439	-0.016310	0.257144
n3	0.150474	0.049456	0.087937	0.158371	0.090149	0.092871	-0.014158	0.122216	-0.045604	0.072592	...	0.474916	0.000589	0.790764	0.568452	0.982045	0.653450	-0.003080	0.003439	-0.016310	0.257144
n4	0.213043	0.044489	-0.050084	0.206547	-0.049874	-0.052992	-0.025001	0.067218	-0.029983	0.122421	...	0.716221	-0.017112	0.740357	0.572091	0.638420	0.614905	-0.001738	-0.002743	-0.018516	0.236066
n5	0.195385	0.047526	-0.078163	0.183541	-0.079906	-0.083847	0.006386	0.111567	-0.055033	0.126787	...	1.000000	0.035034	0.620172	0.838420	0.473535	0.505074	0.007617	0.010722	0.018241	0.218219
n6	0.078587	0.071095	0.011459	0.063391	0.015116	0.014840	-0.039479	-0.045085	-0.065449	0.101787	...	0.035034	1.000000	0.028816	0.074614	0.003909	0.389311	0.001250	0.007528	0.071921	0.189971
n7	0.165615	0.048778	-0.004541	0.162462	-0.001498	-0.002417	-0.032827	0.110750	-0.036238	0.078582	...	0.620172	0.028816	1.000000	0.775460	0.794812	0.826807	0.003370	0.011856	-0.022205	0.346506
n8	0.168819	0.052974	-0.051841	0.157905	-0.047689	-0.050347	-0.019679	0.143347	-0.069583	0.101975	...	0.838420	0.074614	0.775460	1.000000	0.564713	0.638946	0.010150	0.018775	0.031554	0.295409
n9	0.149601	0.049677	0.087556	0.157370	0.089593	0.092418	-0.009577	0.123225	-0.044304	0.071384	...	0.473535	0.003909	0.794812	0.564713	1.000000	0.658532	-0.002603	0.003445	-0.023658	0.243982
n10	0.180359	0.070600	-0.007862	0.170391	-0.002174	-0.003392	-0.029380	0.037015	-0.090501	0.131405	...	0.505074	0.389311	0.826807	0.638946	0.658532	1.000000	0.001545	0.007207	0.011008	0.363553
n11	-0.000150	-0.000164	0.004564	0.000678	0.005023	0.005530	-0.004090	0.003862	0.000099	0.005784	...	0.007617	0.001250	0.003370	0.010150	-0.002603	0.001545	1.000000	0.003660	0.066986	-0.005273
n12	0.002629	-0.000317	0.014585	0.004961	0.017338	0.017924	-0.011054	0.007545	-0.010865	0.012138	...	0.010722	0.007528	0.011856	0.018775	0.003445	0.007207	0.003660	1.000000	0.005364	-0.006556
n13	-0.018744	-0.010489	0.027632	-0.013109	0.029878	0.030846	-0.025557	0.000055	0.000174	0.007702	...	0.018241	0.071921	-0.022205	0.031554	-0.023658	0.011008	0.066986	0.005364	1.000000	0.000261
n14	-0.018671	0.024198	0.205297	0.001727	0.209909	0.216046	-0.044603	0.025525	-0.033871	0.052132	...	0.218219	0.189971	0.346506	0.295409	0.243982	0.363553	-0.005273	-0.006556	0.000261	1.000000
,
44 rows × 44 columns

,
1
# 画出相关性热力图
2
ax = plt.subplots(figsize=(50, 40))#调整画布大小
3
​
4
ax = sns.heatmap(train_corr, vmax=.8, square=True, annot=True)#画热力图   annot=True 显示系数

1
# 找出相关程度
2
data_train1 = data_train.drop(['id','issueDate','policyCode'],axis=1)
3
​
4
plt.figure(figsize=(50, 40))  # 指定绘图对象宽度和高度
5
colnm = data_train1.columns.tolist()  # 列表头
6
mcorr = data_train1[colnm].corr(method="spearman")  # 相关系数矩阵，即给出了任意两个变量之间的相关系数
7
mask = np.zeros_like(mcorr, dtype=np.bool)  # 构造与mcorr同维数矩阵 为bool型
8
mask[np.triu_indices_from(mask)] = True  # 角分线右侧为True
9
cmap = sns.diverging_palette(220, 10, as_cmap=True)  # 返回matplotlib colormap对象
10
g = sns.heatmap(mcorr, mask=mask, cmap=cmap, square=True, annot=True, fmt='0.2f')  # 热力图（看两两相似度）
11
plt.show()

1
​
2
#寻找K个最相关的特征信息
3
k = 15 # number of variables for heatmap
4
cols = train_corr.nlargest(k, 'isDefault')['isDefault'].index
5
​
6
cm = np.corrcoef(data_train[cols].values.T)
7
hm = plt.subplots(figsize=(15, 15))#调整画布大小
8
#hm = sns.heatmap(cm, cbar=True, annot=True, square=True)
9
#g = sns.heatmap(train_data[cols].corr(),annot=True,square=True,cmap="RdYlGn")
10
hm = sns.heatmap(data_train[cols].corr(),annot=True,square=True)
11
​
12
plt.show()

1
#查找出特征变量和target变量相关系数大于0.5的特征变量
2
#寻找K个最相关的特征信息
3
k = 20 # number of variables for heatmap
4
cols = train_corr.nlargest(k, 'isDefault')['isDefault'].index
5
​
6
cm = np.corrcoef(data_train[cols].values.T)
7
hm = plt.subplots(figsize=(20, 20))#调整画布大小
8
#hm = sns.heatmap(cm, cbar=True, annot=True, square=True)
9
#g = sns.heatmap(train_data[cols].corr(),annot=True,square=True,cmap="RdYlGn")
10
hm = sns.heatmap(data_train[cols].corr(),annot=True,square=True)
11
​
12
plt.show()

1
threshold = 0.5
2
​
3
corrmat = data_train.corr()
4
top_corr_features = corrmat.index[abs(corrmat["isDefault"])>threshold]
5
plt.figure(figsize=(10,10))
6
g = sns.heatmap(data_train[top_corr_features].corr(),annot=True,cmap="RdYlGn")

1
threshold = 0.1
2
​
3
corrmat = data_train.corr()
4
top_corr_features = corrmat.index[abs(corrmat["isDefault"])>threshold]
5
plt.figure(figsize=(10,10))
6
g = sns.heatmap(data_train[top_corr_features].corr(),annot=True,cmap="RdYlGn")

1
threshold = 0.1
2
​
3
# Absolute value correlation matrix
4
corr_matrix = data_train1.corr().abs()
5
drop_col=corr_matrix[corr_matrix["isDefault"]<threshold].index
6
print(drop_col)
Index(['loanAmnt', 'installment', 'employmentTitle', 'employmentLength',

       'homeOwnership', 'annualIncome', 'verificationStatus', 'purpose',

       'postCode', 'regionCode', 'dti', 'delinquency_2years', 'openAcc',

       'pubRec', 'pubRecBankruptcies', 'revolBal', 'revolUtil', 'totalAcc',

       'initialListStatus', 'applicationType', 'earliesCreditLine', 'title',

       'n0', 'n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10',

       'n11', 'n12', 'n13', 'n14'],

      dtype='object')
1
drop_columns = ['id','issueDate','policyCode','employmentLength']
1
#merge train_set and test_set
2
train_x =  data_train.drop(['isDefault'], axis=1)
3
​
4
#data_all=pd.concat([train_data,test_data],axis=0,ignore_index=True)
5
data_all = pd.concat([train_x,data_test_a]) 
6
​
7
​
8
data_all.drop(drop_columns,axis=1,inplace=True)
9
#View data
10
data_all.tail()
, , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , ,
loanAmnt	term	interestRate	installment	grade	subGrade	employmentTitle	homeOwnership	annualIncome	verificationStatus	...	n5	n6	n7	n8	n9	n10	n11	n12	n13	n14
199995	7000.0	3	11.14	229.64	2	7	330967.0	1	30000.0	2	...	6.0	11.0	2.0	6.0	2.0	8.0	0.0	0.0	0.0	4.0
199996	6000.0	3	6.24	183.19	1	2	38930.0	1	56000.0	0	...	5.0	14.0	12.0	13.0	6.0	25.0	0.0	0.0	0.0	0.0
199997	14000.0	5	15.88	339.57	3	14	282016.0	2	80000.0	2	...	21.0	18.0	21.0	42.0	13.0	21.0	0.0	0.0	0.0	0.0
199998	8000.0	3	18.06	289.47	4	17	97.0	1	190000.0	0	...	12.0	5.0	8.0	19.0	6.0	11.0	0.0	0.0	0.0	2.0
199999	8000.0	3	6.68	245.85	1	3	320.0	1	46000.0	0	...	3.0	4.0	3.0	4.0	2.0	4.0	0.0	0.0	0.0	0.0
,
5 rows × 42 columns

,
1
# normalise numeric columns
2
cols_numeric=list(data_all.columns)
3
​
4
def scale_minmax(col):
5
    return (col-col.min())/(col.max()-col.min())
6
​
7
data_all[cols_numeric] = data_all[cols_numeric].apply(scale_minmax,axis=0)
8
data_all[cols_numeric].describe()
, , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , ,
loanAmnt	term	interestRate	installment	grade	subGrade	employmentTitle	homeOwnership	annualIncome	verificationStatus	...	n5	n6	n7	n8	n9	n10	n11	n12	n13	n14
count	1000000.000000	1000000.000000	1000000.000000	1000000.000000	1000000.000000	1000000.000000	1000000.000000	1000000.000000	1000000.000000	1000000.000000	...	1000000.000000	1000000.000000	1000000.000000	1000000.000000	1000000.000000	1000000.000000	1000000.000000	1000000.000000	1000000.000000	1000000.000000
mean	0.352426	0.241267	0.308788	0.249261	0.290949	0.314493	0.190541	0.122838	0.006928	0.504916	...	0.114992	0.064298	0.098997	0.106575	0.123628	0.129043	0.000187	0.000815	0.002171	0.072331
std	0.220769	0.427852	0.185588	0.153765	0.215728	0.189582	0.281873	0.135138	0.006435	0.391259	...	0.066913	0.054553	0.053639	0.062380	0.069727	0.059627	0.007204	0.015226	0.012710	0.059909
min	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	...	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000
25%	0.189873	0.000000	0.172897	0.137809	0.166667	0.176471	0.001129	0.000000	0.004152	0.000000	...	0.071429	0.030303	0.060241	0.062992	0.066667	0.088889	0.000000	0.000000	0.000000	0.033333
50%	0.291139	0.000000	0.289330	0.212394	0.333333	0.294118	0.020568	0.200000	0.005910	0.500000	...	0.100000	0.053030	0.084337	0.094488	0.111111	0.122222	0.000000	0.000000	0.000000	0.066667
75%	0.493671	0.000000	0.415888	0.333088	0.333333	0.411765	0.312176	0.200000	0.008182	1.000000	...	0.142857	0.083333	0.120482	0.133858	0.155556	0.155556	0.000000	0.000000	0.000000	0.100000
max	1.000000	1.000000	1.000000	1.000000	1.000000	1.000000	1.000000	1.000000	1.000000	1.000000	...	1.000000	1.000000	1.000000	1.000000	1.000000	1.000000	1.000000	1.000000	1.000000	1.000000
,
8 rows × 42 columns

,
1
​
2
train_data_process = data_train[cols_numeric]
3
train_data_process = train_data_process[cols_numeric].apply(scale_minmax,axis=0)
4
​
5
test_data_process = data_test_a[cols_numeric]
6
test_data_process = test_data_process[cols_numeric].apply(scale_minmax,axis=0)
1
train_data_process.info()
<class 'pandas.core.frame.DataFrame'>

RangeIndex: 800000 entries, 0 to 799999

Data columns (total 42 columns):

 #   Column              Non-Null Count   Dtype  

---  ------              --------------   -----  

 0   loanAmnt            800000 non-null  float64

 1   term                800000 non-null  float64

 2   interestRate        800000 non-null  float64

 3   installment         800000 non-null  float64

 4   grade               800000 non-null  float64

 5   subGrade            800000 non-null  float64

 6   employmentTitle     800000 non-null  float64

 7   homeOwnership       800000 non-null  float64

 8   annualIncome        800000 non-null  float64

 9   verificationStatus  800000 non-null  float64

 10  purpose             800000 non-null  float64

 11  postCode            800000 non-null  float64

 12  regionCode          800000 non-null  float64

 13  dti                 800000 non-null  float64

 14  delinquency_2years  800000 non-null  float64

 15  ficoRangeLow        800000 non-null  float64

 16  ficoRangeHigh       800000 non-null  float64

 17  openAcc             800000 non-null  float64

 18  pubRec              800000 non-null  float64

 19  pubRecBankruptcies  800000 non-null  float64

 20  revolBal            800000 non-null  float64

 21  revolUtil           800000 non-null  float64

 22  totalAcc            800000 non-null  float64

 23  initialListStatus   800000 non-null  float64

 24  applicationType     800000 non-null  float64

 25  earliesCreditLine   800000 non-null  float64

 26  title               800000 non-null  float64

 27  n0                  800000 non-null  float64

 28  n1                  800000 non-null  float64

 29  n2                  800000 non-null  float64

 30  n3                  800000 non-null  float64

 31  n4                  800000 non-null  float64

 32  n5                  800000 non-null  float64

 33  n6                  800000 non-null  float64

 34  n7                  800000 non-null  float64

 35  n8                  800000 non-null  float64

 36  n9                  800000 non-null  float64

 37  n10                 800000 non-null  float64

 38  n11                 800000 non-null  float64

 39  n12                 800000 non-null  float64

 40  n13                 800000 non-null  float64

 41  n14                 800000 non-null  float64

dtypes: float64(42)

memory usage: 256.3 MB
1
cols_numeric_left = cols_numeric[0:21]
2
cols_numeric_right = cols_numeric[21:]
1
## Check effect of Box-Cox transforms on distributions of continuous variables
2
​
3
train_data_process = pd.concat([train_data_process, data_train['isDefault']], axis=1)
4
​
5
fcols = 6
6
frows = len(cols_numeric_left)
7
plt.figure(figsize=(4*fcols,4*frows))
8
i=0
9
​
10
for var in cols_numeric_left:
11
    dat = train_data_process[[var, 'isDefault']].dropna()
12
        
13
    i+=1
14
    plt.subplot(frows,fcols,i)
15
    sns.distplot(dat[var] , fit=stats.norm);
16
    plt.title(var+' Original')
17
    plt.xlabel('')
18
        
19
    i+=1
20
    plt.subplot(frows,fcols,i)
21
    _=stats.probplot(dat[var], plot=plt)
22
    plt.title('skew='+'{:.4f}'.format(stats.skew(dat[var])))
23
    plt.xlabel('')
24
    plt.ylabel('')
25
        
26
    i+=1
27
    plt.subplot(frows,fcols,i)
28
    plt.plot(dat[var], dat['isDefault'],'.',alpha=0.5)
29
    plt.title('corr='+'{:.2f}'.format(np.corrcoef(dat[var], dat['isDefault'])[0][1]))
30
 
31
    i+=1
32
    plt.subplot(frows,fcols,i)
33
    trans_var, lambda_var = stats.boxcox(dat[var].dropna()+1)
34
    trans_var = scale_minmax(trans_var)      
35
    sns.distplot(trans_var , fit=stats.norm);
36
    plt.title(var+' Tramsformed')
37
    plt.xlabel('')
38
        
39
    i+=1
40
    plt.subplot(frows,fcols,i)
41
    _=stats.probplot(trans_var, plot=plt)
42
    plt.title('skew='+'{:.4f}'.format(stats.skew(trans_var)))
43
    plt.xlabel('')
44
    plt.ylabel('')
45
        
46
    i+=1
47
    plt.subplot(frows,fcols,i)
48
    plt.plot(trans_var, dat['isDefault'],'.',alpha=0.5)
49
    plt.title('corr='+'{:.2f}'.format(np.corrcoef(trans_var,dat['isDefault'])[0][1]))
1
## 将训练数据集划分一下，查看特征值的重要程度
2
from sklearn.model_selection import train_test_split
3
​
4
## 测试集大小为20%， 80%/20%分
5
x_train, x_test, y_train, y_test = train_test_split(train_data_process, data_train['isDefault'], test_size = 0.2, random_state = 2020)
1
from sklearn.metrics import accuracy_score
2
from xgboost import plot_importance
3
from xgboost.sklearn import XGBClassifier
4
​
5
def estimate(model,data):
6
​
7
    #sns.barplot(data.columns,model.feature_importances_)
8
    ax1=plot_importance(model,importance_type="gain")
9
    ax1.set_title('gain')
10
    ax2=plot_importance(model, importance_type="weight")
11
    ax2.set_title('weight')
12
    ax3 = plot_importance(model, importance_type="cover")
13
    ax3.set_title('cover')
14
    plt.show()
15
def classes(data,label,test):
16
    model=XGBClassifier()
17
    model.fit(data,label)
18
    ans=model.predict(test)
19
    estimate(model, data)
20
    return ans
21
 
22
ans=classes(x_train,y_train,x_test)
23
pre=accuracy_score(y_test, ans)
24
print('acc=',accuracy_score(y_test,ans))
/opt/conda/lib/python3.6/site-packages/sklearn/preprocessing/label.py:151: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.

  if diff:



acc= 0.805975
1
## OK，开始训练模型吧
2
## 定义 XGBoost模型 
3
clf = XGBClassifier()
4
# 在训练集上训练XGBoost模型
5
clf.fit(x_train, y_train)
XGBClassifier(base_score=0.5, booster='gbtree', colsample_bylevel=1,
,       colsample_bynode=1, colsample_bytree=1, gamma=0, learning_rate=0.1,
,       max_delta_step=0, max_depth=3, min_child_weight=1, missing=None,
,       n_estimators=100, n_jobs=1, nthread=None,
,       objective='binary:logistic', random_state=0, reg_alpha=0,
,       reg_lambda=1, scale_pos_weight=1, seed=None, silent=None,
,       subsample=1, verbosity=1)
1
## 在训练集和测试集上分布利用训练好的模型进行预测
2
train_predict = clf.predict(x_train)
3
test_predict = clf.predict(x_test)
4
from sklearn import metrics
5
​
6
## 利用accuracy（准确度）【预测正确的样本数目占总预测样本数目的比例】评估模型效果
7
print('The accuracy of the Logistic Regression is:',metrics.accuracy_score(y_train,train_predict))
8
print('The accuracy of the Logistic Regression is:',metrics.accuracy_score(y_test,test_predict))
9
​
10
## 查看混淆矩阵 (预测值和真实值的各类情况统计矩阵)
11
confusion_matrix_result = metrics.confusion_matrix(test_predict,y_test)
12
print('The confusion matrix result:\n',confusion_matrix_result)
13
​
14
​
/opt/conda/lib/python3.6/site-packages/sklearn/preprocessing/label.py:151: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.

  if diff:
The accuracy of the Logistic Regression is: 0.8039625

The accuracy of the Logistic Regression is: 0.805975

The confusion matrix result:

 [[126883  29526]

 [  1518   2073]]
/opt/conda/lib/python3.6/site-packages/sklearn/preprocessing/label.py:151: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.

  if diff:
1
##共有126883 + 2073个样本预测正确，29526 + 1518 个样本预测错误。
1
# 利用热力图对于结果进行可视化
2
plt.figure(figsize=(8, 6))
3
sns.heatmap(confusion_matrix_result, annot=True, cmap='Blues')
4
plt.xlabel('Predicted labels')
5
plt.ylabel('True labels')
6
plt.show()

1
sns.barplot(y=train_data_process.columns, x=clf.feature_importances_)
<AxesSubplot:>

1
​
